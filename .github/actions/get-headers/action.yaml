name: "Fetch Site Headers"
description: "Fetches the headers for a given site"

inputs:
  site:
    description: "The site to fetch headers for"
    required: true
    default: "https://www.build.com/"

outputs:
  site-version:
    description: "The version of the site"
    value: ${{ steps.get-headers.outputs.site-version }}

runs:
  using: composite
  steps:
    - name: Fetch Headers
      id: get-headers
      uses: actions/github-script@v6
      with:
        script: |
          const site = "${{ inputs.site }}";
          fetch(site).then((res) => {
            console.log(res.headers);
            const siteVersion = res.headers.get("x-site-version");
            console.log({ headers })
            core.setOutput("site-version", siteVersion);
          }).catch((err) => {
            console.log(err);
          });
